<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl" ?>
<!--
# NeXus - Neutron and X-ray Common Data Format
# 
# Copyright (C) 2008-2022 NeXus International Advisory Committee (NIAC)
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<definition
    name="NXazint"
    extends="NXobject"
    type="group"
    category="application"
    xmlns="http://definition.nexusformat.org/nxdl/3.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd "
    >
    <symbols>
        <doc>
            The symbol(s) listed here will be used below to coordinate datasets with the same shape.
        </doc>
        <symbol name="nImg">
            <doc>Number of intergated images</doc>
        </symbol>
        <symbol name="nRad">
            <doc>Number of radial bins</doc>
        </symbol>
        <symbol name="nRadEdge">
            <doc>Number of radial bins edges (nRad+1)</doc>
        </symbol>
    </symbols>

    <doc>
        This application definition describes data from two-dimensional area detectors that has been
        integrated azimuthally with a certain radial binning in units of q or 2theta.
    </doc>

    <field name="data" type="NX_NUMBER" optional="false">
        <dimensions rank="2">
            <dim index="1" value="nImg" />
            <dim index="2" value="nRad" />
        </dimensions>
        <attribute name="long_name" type="NX_CHAR">
            <enumeration>
                <item value="intensity"></item>
            </enumeration>
        </attribute>
        <attribute name="units" type="NX_ANY">
            <enumeration>
                <item value="arbitrary units"></item>
            </enumeration>
        </attribute>
    </field>

    <field name="data_errors" type="NX_NUMBER"  optional="true">
        <dimensions rank="2">
            <dim index="1" value="nImg" />
            <dim index="2" value="nRad" />
        </dimensions>
        <attribute name="long_name" type="NX_CHAR">
            <enumeration>
                <item value="estimated errors on intensity"></item>
            </enumeration>
        </attribute>
        <attribute name="units" type="NX_ANY">
            <enumeration>
                <item value="arbitrary units"></item>
            </enumeration>
        </attribute>
    </field>

    <field name="data_weights" type="NX_NUMBER"  optional="true">
        <dimensions rank="1">
            <dim index="1" value="nRad" />
        </dimensions>
        <attribute name="long_name" type="NX_CHAR">
            <enumeration>
                <item value="values used to normalize data"></item>
            </enumeration>
        </attribute>
        <attribute name="units" type="NX_ANY">
            <enumeration>
                <item value="arbitrary units"></item>
            </enumeration>
        </attribute>
    </field>
    
    <field name="radial_axis" type="NX_NUMBER" optional="false">
        <dimensions rank="1">
            <dim index="1" value="nRad" />
        </dimensions>
        <attribute name="long_name" type="NX_CHAR">
            <enumeration>
                <item value="q"></item>
                <item value="scattering vector magnitude"></item>
                <item value="2theta"></item>
            </enumeration>
        </attribute>
        <attribute name="units" type="NX_ANY" > <!-- NX_ANGLE | NX_PER_LENGTH does not work -->
            <enumeration>
                <item value="1/angstrom"></item>
                <item value="1/nm"></item>
                <item value="degrees"></item>
            </enumeration>
        </attribute>
    </field>

    <field name="radial_axis_edges" type="NX_NUMBER" optional="true">
        <dimensions rank="1">
            <dim index="1" value="nRadEdge" />
        </dimensions>
        <attribute name="long_name" type="NX_CHAR">
            <enumeration>
                <item value="edges of q bins"></item>
                <item value="edges of tth bins"></item>
            </enumeration>
        </attribute>
        <attribute name="units" type="NX_ANY" > <!-- NX_ANGLE | NX_PER_LENGTH does not work -->
            <enumeration>
                <item value="1/angstrom"></item>
                <item value="1/nm"></item>
                <item value="degrees"></item>
            </enumeration>
        </attribute>
    </field>
	
	<group type="NXprocess" name="integration" recommended="true">
	    <field name="program" type="NX_CHAR">
		<doc> Name of algorithm used in the processing.</doc>
	    </field>
	    <field name="version" type="NX_CHAR" optional="true">
		<doc> Version of the algorithm used in the processing. </doc>
	    </field>
	    <field name="date" type="NX_DATE_TIME">
		<doc> Date and time of processing. </doc>
	    </field>
	    <field name="reference" type="NX_CHAR" optional="true">
		<doc> Citation or other references for the algorithm used in the processing. </doc>
	    </field>
	    <field name="note" type="NX_CHAR" optional="true">
		<doc> Notes required to help interpret the data, e.g. on coordinate systems. </doc>
	    </field>

		<group type="NXparameters" name="parameters" recommended="true">
			<doc>
			Input parameters should exactly match those required by the processing algorithm.
			For example, `azint` requires `error_model`, `mask_file`, `pixel_splitting`, `poni`, etc.
			</doc>
			<field name="ERRORMODEL" type="NX_CHAR" optional="true">
				<doc> Model used to evaluate data errors. </doc>
			</field>
			<field name="NORMALIZATIONMODEL" type="NX_CHAR" optional="true">
				<doc> Model used to normalize data. </doc>
			</field>
			<field name="POLARIZATIONFACTOR" type="NX_FLOAT" optional="true">
				<doc> Polarization factor. </doc>
			</field>
			<field name="SOLIDANGLECORRECTION" type="NX_BOOLEAN" optional="true">
				<doc> Indicates the solid angle correction is applied. </doc>
			</field>
			<field name="GEOMETRYFILE" type="NX_CHAR" optional="true">
				<doc> Text content of the geometry description file used by the processing algorithm (e.g. content of the PONI file). </doc>
			</field>
			<field name="MASKFILE" type="NX_CHAR" optional="true">
				<doc> Filename or standartized data-path of the mask used for processing. </doc>
			</field>
			<field name="NUMBINS" type="NX_INT" optional="true">
				<doc> Number of radial or azimuthal bins. </doc>
			</field>
			<field name="PIXELSPLITTING" type="NX_INT" optional="true">
				<doc> Pixel splitting parameter. </doc>
			</field>
			<field name="UNITS" type="NX_CHAR" optional="true">
				<doc> (Radial) axis unit parameter (e.g. 1/angstrom or radians). </doc>
			</field>
			<field name="ENERGYWAVELENGTH" type="NX_FLOAT" optional="true">
				<doc> Energy or wavelength value. </doc>
				<attribute name="units" type="NX_ANY" optional="true" /> <!-- NX_LENGTH | NX_ENERGY does not work -->
			</field>
		</group>
		    
	</group>
	
    <field name="program_name" type="NX_CHAR" optional="true">
        <doc> Name of the program or script that made this data.
        This can be different from the processing algorithm.
        </doc>
        <attribute name="version" type="NX_CHAR" optional="true">
            <doc> Version of the program or script that made this data. </doc>
        </attribute>
    </field>
    
	<group type="NXparameters" name="corrections" recommended="true">
		<doc>
		Common corrections and approximations applied during processing are listed here.
		Note: This group is rather an information for the analysis software rather than
		list of arguments used by the processing algorithm.
	    </doc>
	    <field name="polarization" type="NX_BOOLEAN" recommended="true">
			<doc> Indicates the polarization correction was applied. </doc>
	    </field>
		<field name="solid_angle" type="NX_BOOLEAN" recommended="true">
			<doc> Indicates the solid angle correction was applied. </doc>
	    </field>
		<field name="CORRECTIONNAME" type="NX_BOOLEAN" optional="true">
			<doc> Indicates other applied corrections (air absorption, parallax etc.). </doc>
	    </field>
	</group>

</definition>
